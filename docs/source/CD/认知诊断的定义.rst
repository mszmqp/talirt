========================
认知诊断的定义
========================


认知诊断
========

    raw:: html

       <p style="text-indent:2em">

    如果用量化的方法描述人所具有的认知属性，应该用“模式”或“结构”较为恰当。但是，无论是经典测量理论、项目反应理论还是概化理论，提供的心理测量结果都是单一的分数，这显然是有缺陷的，因为他无法报告被试的认知结构，不能给出诊断的建议。直到二十世纪后期，随着认知心理学对心理测量的渗入，以及各种现代计算机的方法的运用,突破了传统测量理论的局限性,诞生了认知诊断理论,这是心理测量史上具有重大意义的进展。

    .. raw:: html

       </p>
       <p style="text-indent:2em">

    从线性逻辑斯蒂模型、规则空间模型、属性层次模型到统一模型
    、融合模型,目前已经出现的认知诊断模型就超过 100 多种

    .. raw:: html

       <p style="text-indent:2em">

    近十多年来认知诊断理论取得了令人瞩目的成就,但是其缺点也是显而易见的。出现了如此多的模型,而每种模型都有其不足之处,迄今还没有形成一种完整的体系。很多研究尚停留在蒙特卡罗模拟或小规模的实验研究阶段,真正的大范围实际应用还不多见。

    .. raw:: html

       </p>..

1. 认知诊断的定义
-----------------

当前大部分测验只能提供单一的测验总分或能力值，但具有相同分数或能力值学生的认知结构（或称知识状态）可能不同，因此对他们采取的教学补救措施是不一样的，由此便引出了认知诊断：

**通常称对个体知识架构、加工技能或认知过程（统称属性，attribute）的诊断评估为认知诊断评估（ :math:`CDA` ）或认知诊断（ :math:`CD`,
Congnitive Diagnostic）**

**认知诊断的主要任务是挖掘更多认知加工信息**

**主要思想：**
 :math:`CDA` 通过测验获得被试在测验上可观察的反应模式（ :math:`ORP` ）而推知该被试不可观察的知识状态（ :math:`KS` ，
knowledge state）。

2. 认知诊断的发展
-----------------

** ## 3. 认知诊断的相关理论
**认知诊断理论主要包含 :math:`Q` 矩阵理论和认知诊断模型两个部分**

3.1 Q矩阵理论
~~~~~~~~~~~~~

Q矩阵理论的先驱是Tatsuoka教授，她认为 :math:`Q` 矩阵理论欲确定学生不可观察的知识状态，并且运用可以直接观察得到的反应模式（ :math:`ORP` ）表示这些知识状态。

学生的知识状态由属性向量表征，属性表示测验项目的特征（知识点），是学生正确解决特定项目所需要的认知加工能力和技能。

一个完整的 :math:`Q` 矩阵理论包括：属性层级结构（ :math:`AHS` ）、邻接矩阵（ :math:`A` ）、可达矩阵（ :math:`R` ）、缩减矩阵（ :math:`Qr` ）、学生 :math:`Q` 矩阵（ :math:`Qs` ）、测验 :math:`Q` 矩阵（ :math:`Qt` ）和期望反应模式（ :math:`ERP` ）。

通过一个具体例子对Q矩阵理论进行详细阐述：
首先，假定某份认知诊断测验（可以理解为测验试卷）的属性层级结构( :math:`AHS`)如下图

|4d1610df5f3b7bc0bb6bc1da16812d95.png| @w=300

图中可知，这份测验包含 :math:`6` 个属性（ **知识点** ），属性之间存在层级关系。例如，属性 :math:`1` 是属性 :math:`2` 和属性 :math:`4` 的先决关系，即掌握属性 :math:`2` 之前必须先掌握属性 :math:`1` 。这种层级关系是必须的，例如掌握加法之前必须先掌握乘法。

根据上图的知识点层级关系，可以得到邻接矩阵 :math:`A` 阵，描述知识点之间的直接关系（“ :math:`1` ”表示存在关系，“ :math:`0` ”表示不存在关系）。如下表：

|f86e5239e42d5e9f03c291f293f2cbe0.png| @w=400

由 :math:`A` 阵与同阶单位阵的和 :math:`A+I` ，通过Warshall算法可以得到可达矩阵 :math:`R` 阵， :math:`R` 阵描述属性间直接、间接以及和自身关系的矩阵（“ :math:`1` ”表示存在关系，“ :math:`0` ”表示不存在关系）。如下表：

|28837dfcd7045a614cce81ea0118d2ef.png| @w=400

在得到 :math:`R` 阵之后，可以通过删除法或者扩张算法导出所有可能的项目类别，即在上述属性（知识点）层级结构之下，一份测验可以编制出来的所有题目类型，记做缩减矩阵 :math:`Qr` 阵， **行代表属性，列代表项目类** （“ :math:`1` ”表示项目考察了属性，“ :math:`0` ”表示没有考察，例如表中的项目类型 :math:`3` 考察了属性 :math:`A1` 、 :math:`A2` 、 :math:`A3` ）。本例中最多只能确定 :math:`15` 种题目类型, :math:`Qr` 矩阵如下：

|da61beef433265aef35234798a0a4a52.png| @w=600

将缩减矩阵加上一列全为“ :math:`0` ”的向量，就得到了所有可能的知识状态（ :math:`ks` ）集合，也就是学生类型，记做 :math:`Qs` 。 :math:`Qs` **矩阵行表示属性，列代表学生类型** （“ :math:`1` ”表示该类学生掌握了对应属性，“ :math:`0` ”该类学生没有掌握对应属性，例如类型 :math:`3` 的学生掌握了属性 :math:`A1` 、 :math:`A2` 、 :math:`A3` ）全为“ :math:`0` ”的列表示该类学生没有掌握任何属性，所以共有 :math:`16` 种知识状态集合。

|f2331b6d0948ab7e610ded64c09d87f2.png| @w=600

**测验矩阵 :math:`Qt` 的编制** ，
*** :math:`Qt` 矩阵中的列是 :math:`Qr` 阵的列自由组合得到*** ， **测验矩阵 :math:`Qt` 的作用指导编制测验题目，也就是测验试卷**

首先要搞明白有了缩减矩阵 :math:`Qr` 为什么还要 :math:`Qt` 。有的考试知识点比较多，层级关系也比较分散，这就会造成 :math:`Qr` 种类非常多，一个极端的例子，比如一份试卷包含 :math:`16` 个互相独立的属性，那么 :math:`Qr` 的种类有 :math:`2^{16}` 种，而一份试卷不可能包含这么多种类的题目，所以 :math:`Qt` 是 :math:`Qr` 的一个子集，但是 :math:`Qt` 的编制需要满足包含至少一个 :math:`R` 阵，这样才能保证知识状态（ :math:`ks` ）与 :math:`ERP` 一一对应。《认知诊断测验蓝图的设计，丁树良》

期望反应模式（ :math:`ERP` ）指学生在不存在任何失误和猜测的情况下对题目的作答反应模式，即学生掌握了题目考察的属性就能答对该题，只要一个属性未掌握就答不对该题。但在现实中，学生在作答时或多或少都会存在一些失误和猜测，因此，期望反应模式是一种理想化的反应模式。

期望反应模式（ :math:`ERP` ）的计算：将 :math:`Qs` 矩阵中的列（ :math:`Qs` 中每一列代表一类“期望被试”的知识状态）与测验矩阵 :math:`Qt` 中的列（ :math:`Qt` 中每一列表示一个测验题目包含的知识属性）做向量减法，如果成“包含”关系，即所得结果中没有出现 :math:`-1` ，记为 :math:`1` ，否则为 :math:`0`
所以得到的某个“期望被试”的期望反应模式是一个长度为 :math:`Qt` 项目数的 :math:`01` 向量
\*“期望被试”指的是 :math:`Qs` 中某一知识状态类型的被试

|9c8c7b6a01255d71a8bbcd7339f74289.png| @w=600

将上述概念串联起来： 1.
首先确定属性的范围和层级关系（ :math:`AHS` ），即确实知识点结构树 2.
计算邻接矩阵 :math:`A` 阵，反应了属性间的直接关系 3.
根据 :math:`A` 阵计算 :math:`R` 阵，反应属性间直接、间接及自身的关系
4.
根据 :math:`R` 阵通过扩张法（推荐）或缩减法计算缩减矩阵 :math:`Qr` ，表示所有的项目类型
5.
将 :math:`Qr` 加上全为 :math:`0` 的一列，得到学生的知识状态矩阵 :math:`Qs` ，表示学生所有可能的知识状态
6. 编制测验矩阵 :math:`Qt` ，作为测验试卷的蓝图 7.
由 :math:`Qs` 和 :math:`Qt` ，计算出与 :math:`Qs` 一一对应的 :math:`ERP`

之后根据测验矩阵 :math:`Qt` 编制真实的测试试卷，得到学生真实的作答反应（ :math:`ORP` ）。将真实的作答数据通过认知诊断模型（ :math:`CDM` ）分类到与之对应的期望反应模式中。
\*这里的分类只对应一部分的认知诊断模型，有的 :math:`CDM` 是将知识状态作为代估计的参数。

3.2 属性界定方法
~~~~~~~~~~~~~~~~

注：单纯的数据驱动属性界定方法，只是从统计上得出属性类标，所识别出来的属性含义不明，有待专家进一步分析内涵和命名，并且得到的属性数有待专家主观判断。
### 3.3 认知诊断模型 #### 3.3.1 规则空间模型（RSM）
规则空间模型（ :math:`RSM` ）通过下面 :math:`1` ～ :math:`5` 步建立分类空间，对被试进行分类，诊断出被试的知识状态：

**1** ，通过项目反应理论（ :math:`IRT` ）分别估计出理想反应模式（ :math:`ERP` ）和观察反应模式（ :math:`ORP` ）所对应的能力值和每个项目的项目参数（题目的难度值、区分度、猜测值）

**2** ，根据估计时使用的项目反应理论模型，由被试 :math:`i` 的估计能力值 :math:`\theta _{ i }` 和估计的项目参数，计算被试 :math:`i` 在项目 :math:`j` 上的答对概率 :math:`P_{ j }(\theta _{ i })` 和被试 :math:`i` 的真分数 :math:`t(\theta _{ i })`

.. code:: math

    t(\theta _{ i })=\frac { \sum _{ i }^{ M }{ P_{ j }({ \theta  }_{ i }) }  }{ M }

    其中 i=1,2,.....N(学生人数)，j=1,2,....M(表题目数量)

**3** ，计算异常反应模式指标 :math:`\xi` ，该指标用来度量观察反应模式的异常程度， :math:`\xi`
越大，表示被试在难度大的项目回答正确而难度小的项目回答错误，反应模式越异常.
 :math:`\xi` 的计算方法：
令 :math:`f({ x }_{ i })=({ P }{ (\theta  }_{ i })-{ x }_{ i })({ P }{ (\theta  }_{ i })-T({ \theta  }_{ i }))^{ T }` ，其中 :math:`{ x }_{ i }` 是某个被试的观察反应模式， :math:`T({ \theta  }_{ i })` 是被试真分数组成的 :math:`M` 维向量。对 :math:`f({ x }_{ i })` 进行标准化，即

.. code:: math

    { \xi  }_{ i }=\frac { f({ x }_{ i }) }{ \left[ varf({ x }_{ i }) \right] ^{ 1/2 } }

从而得出序偶 :math:`(\theta_{i},\xi_{i})`
可以证明 :math:`\theta_{i}` 和 :math:`\xi_{i}` 正交，将 :math:`\theta_{i}` 和 :math:`\xi_{i}` 构成的二维空间称为规则空间，这样一来观察反应模式或者理想反应模式就可以转化为规则空间中的二维坐标

**4** ，把理想反应模式对应的 :math:`R_{r}=(\theta_{r},\xi_{r})` 称之为纯规则点，然后计算被试 :math:`i` 观察反应模式的规则点 :math:`Z_{i}=(\theta_{i},\xi_{i})` 与每个纯规则点的马氏距离

.. math::

    { D }_{ ir }^{ 2 }=({ Z }_{ i }-{ R }_{ i })\sum _{ r }^{  }{ ({ Z }_{ i }-{ R }_{ i })^{ t } }

**5** ，对于距离被试规则点最近的多个纯规则点(设置一个阈值 :math:`\alpha` ， :math:`D^{ 2 }<\alpha`)而言，可采用贝叶斯决策将被试分类

3.3.2 属性层级模型AHM
^^^^^^^^^^^^^^^^^^^^^

 :math:`AHM` **需要先确定属性间的层级关系，即属性层级结构(AHS)** 。

分类方法 :math:`A` （ :math:`AHM-A` ）：将需要判别的一个观察反应模式与所有的期望反应模式逐个比较，求取观察反应模式与每一个期望反应模式相似的概率，最后将观察反应模式判归于有最大相似概率的期望反应模式，实际上也就是将拥有该观察反应模式的被试判定为有最大相似概率的期望反应模式所对应的属性掌握模式。
将观察反应模式 :math:`X_{i}` 与每个期望反应模式 :math:`V_{r}`
逐个元素进行比较。记 :math:`D_{ir}=V_{r}-X_{i}`
产生一个以 :math:`\left\{ -1,0,+1 \right\}` 为元素的 :math:`M` 维向量，

当 :math:`D_{ir}` 中元素 :math:`d_{j}=0` 时表示被试 :math:`i` 在项目 :math:`j` 上既无失误也无猜测；

当 :math:`d_{j}=1` 时，表示被试 :math:`i` 在项目 :math:`m` 上产生 :math:`(1->0)` 失误，其概率为 :math:`1-P_{m}(\theta_{r})` ，
 :math:`\theta_{r}` 为第 :math:`r` 个理想反应模式的能力估计值，
 :math:`P_{m}(\theta_{r})` 表示能力值为 :math:`\theta_{r}` 的期望被试答对第 :math:`m` 题的概率；

当 :math:`d_{j}=-1` 时，表示被试i在项目k上产生 :math:`(1->0)` 猜测，其概率为 :math:`P_{k}(\theta_{r})` ，
 :math:`P_{k}(\theta_{r})` 表示能力为 :math:`\theta_{r}` 的被试答对第 :math:`k` 题的概率。

 :math:`A` 方法考察失误和猜测的情形，对于第 :math:`r` 个理想反应模式，计算发生失误和猜测的似然为：

.. math::

    P_{ rExpected }(\theta )=\prod _{ k=1 }^{ K }{ { P }_{ m }({ \theta  }_{ r }) } \prod _{ m=1 }^{ L }{ \left[ 1-{ P }_{ m }({ \theta  }_{ r }) \right]  }

表示发生了 :math:`K` 个从 :math:`(0->1)` 的猜测， :math:`L` 个从 :math:`(1->0)` 的失误。
**计算 :math:`X_{i}` 在每个理想反应模式下的似然值，并把 :math:`X` 归到使 :math:`P_{ rExpected }(\theta )` 值最大的类中，即归到似然值最大的类中。**
\*这里计算的能力值是理想反应模式下的能力值

方法 :math:`B(AHM-B)` ：认为观察反应模式 :math:`X_{i}` 的知识状态，要么为 :math:`X_{i}` 包含的理想反应模式对应的知识状态，要么取 :math:`X` 不包含的理想反应模式中似然值最大的理想反应模式对应的知识状态，似然值的计算方法仅取 :math:`A` 中的失误部分，即

.. math::

    \prod _{ m=1 }^{ L }{ \left[ 1-{ P }_{ m }({ \theta  }_{ r }) \right] }

最小化广义距离判别法（ :math:`GDD` ）：

.. math::

    d({ X }_{ i },{ V }_{ r })=\sum _{ j=1 }^{ M }{ d({ X }_{ ij },{ V }_{ rj }) } =\sum _{ j=1 }^{ M }{ \left| { X }_{ ij }-{ V }_{ rj } \right|  } { P }_{ j }({ \theta  }_{ i })^{ { X }_{ ij } }(1-{ P }_{ j }({ \theta  }_{ i }))^{ 1-{ X }_{ ij } }

**该方法以观察反应模式估计的能力值为基准** ，
计算每个项目答对的概率 :math:`{ P }_{ j }({ \theta  }_{ i })` 与答错概率 :math:`1-{ P }_{ j }({ \theta  }_{ i })` ，
然后与理想反应模式进行匹配，
理想反应模式与观察反应模式元素相同，定义距离为 :math:`0` ；
理想反应模式为 :math:`0` ，观察反应模式为 :math:`1` ，定义距离为 :math:`{ P }_{ j }({ \theta  }_{ i })` ，反之，定义距离为 :math:`1-{ P }_{ j }({ \theta  }_{ i })` ，
使得距离最小的理想反应模式对应的知识状态为被试的知识状态

\*AHM的分类方法还可采用神经网络

3.3.3 确定性输入噪声与门模型DINA
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

 :math:`DINA` 的概率模型：

.. math::

    P(Y_{ ij }=1|\alpha _{ i })={ (1-S_{ j }) }^{ \eta _{ ij } }{ g }_{ j }^{ 1-\eta _{ ij } }

 :math:`{ \eta  }_{ ij }`:
描述了被试 :math:`i` 与项目 :math:`j` 之间的关系，被试 :math:`i` 是否掌握了项目 :math:`j` 所考查的所有属性。

 :math:`{ \eta  }_{ ij }=\prod _{ k=1 }^{ K }{ { { \alpha  }_{ ik } }^{ { q }^{ jk } } }`
：
若 :math:`{ \eta  }_{ ij }=1` ，说明被试 :math:`i` 掌握了项目 :math:`j` 的所有所有属性；若 :math:`{ \eta  }_{ ij }=0` ，说明被试 :math:`i` 至少未掌握了项目 :math:`j` 的所考查的一个属性。 :math:`{ \alpha  }_{ ik }` 指学生 :math:`i` 是否掌握了第 :math:`k` 个属性； :math:`{ q }^{ jk }` 表示项目j是否考察了属性 :math:`k` 。

 :math:`S_{ j }=P(Y_{ ij }=0|{ \eta  }_{ ij }=1)`
表示被试 :math:`i` 在项目 :math:`j` 上失误的概率，即被试掌握了项目 :math:`j` 考察的所有属性，但答错的概率。

 :math:`g_{ j }=P(Y_{ ij }=1|{ \eta  }_{ ij }=0)`
表示被试 :math:`i` 在项目 :math:`j` 上猜测的概率，即被试未掌握项目 :math:`j` 考察的所有属性，但答对的概率。

在理想变量已知，项目参数确定之后，就可以计算被试 :math:`i` 在项目 :math:`j` 上的正确作答概率。
因此，理想反应变量取值为1的被试组在项目 :math:`j` 上的正确作答概率，在其不失误的情况下为1，在存在失误的情况下为 :math:`1-S_{j}` ；理想反应变量取值为0的被试组在项目 :math:`j` 上的正确作答概率，在其不猜测的情况下为0，在存在猜测的情况下为 :math:`g_{j}` 。

** :math:`DINA` 模型将失误和猜测仅仅定义在项目水平上，即失误和猜测只存在于不同的项目间，不存在于不同的属性间，也不存在于不同的被试之间，不同的被试在同一个项目上失误概率和猜测概率是相等的。**
所以 :math:`DINA` 模型项目参数的个数只与项目个数有关，对于一个有 :math:`M` 个项目的测验来说， :math:`DINA` 模型的项目参数为 :math:`2M` 个。

以下是采用 :math:`EM` 算法对 :math:`DINA` 模型进行进行参数估计的流程：

|9dff50da0c308fead359fb693a871e02.png| @w=400

**在项目参数（这里指猜测参数和失误参数）已知的情况下通过极大似然估计得到被试的知识状态。也可使用其他经典的估计算法，如最大后验估计方法（MAP）和期望后验估计方法（EAP），有研究认为EAP的效果较好。**

认知诊断完整流程总结
^^^^^^^^^^^^^^^^^^^^

|667f9189e2e9f17ee4d3df58ca4b752d.png| @w=500

4. 认知诊断实例（AHM实例）
--------------------------

5. 相关算法
-----------

5.1 Q矩阵中的算法
~~~~~~~~~~~~~~~~~

5.1.1 计算可达矩阵R——Warshall算法
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

5.1.2 计算缩减矩阵Qr——扩张法
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

5.2 参数估计算法
~~~~~~~~~~~~~~~~

5.2.1 极大似然估计MLE
^^^^^^^^^^^^^^^^^^^^^

5.2.2 EM算法
^^^^^^^^^^^^

5.2.1 MCMC算法
^^^^^^^^^^^^^^

参考文献
--------

.. |4d1610df5f3b7bc0bb6bc1da16812d95.png| image:: evernotecid://AD440EA1-9A2F-4139-BFDE-B8EF07F07836/appyinxiangcom/18915170/ENResource/p144
.. |f86e5239e42d5e9f03c291f293f2cbe0.png| image:: evernotecid://AD440EA1-9A2F-4139-BFDE-B8EF07F07836/appyinxiangcom/18915170/ENResource/p82
.. |28837dfcd7045a614cce81ea0118d2ef.png| image:: evernotecid://AD440EA1-9A2F-4139-BFDE-B8EF07F07836/appyinxiangcom/18915170/ENResource/p84
.. |da61beef433265aef35234798a0a4a52.png| image:: evernotecid://AD440EA1-9A2F-4139-BFDE-B8EF07F07836/appyinxiangcom/18915170/ENResource/p85
.. |f2331b6d0948ab7e610ded64c09d87f2.png| image:: evernotecid://AD440EA1-9A2F-4139-BFDE-B8EF07F07836/appyinxiangcom/18915170/ENResource/p86
.. |9c8c7b6a01255d71a8bbcd7339f74289.png| image:: evernotecid://AD440EA1-9A2F-4139-BFDE-B8EF07F07836/appyinxiangcom/18915170/ENResource/p87
.. |9dff50da0c308fead359fb693a871e02.png| image:: evernotecid://AD440EA1-9A2F-4139-BFDE-B8EF07F07836/appyinxiangcom/18915170/ENResource/p142
.. |667f9189e2e9f17ee4d3df58ca4b752d.png| image:: evernotecid://AD440EA1-9A2F-4139-BFDE-B8EF07F07836/appyinxiangcom/18915170/ENResource/p182
